extends ../navbar

block content
  .container-fluid.px-4.py-4
    .row.mb-4
      .col-12
        h1.text-center.mb-4
          if isEdit
            i.fas.fa-edit.me-2
            | Edit Category
          else
            i.fas.fa-folder-plus.me-2
            | Add New Category
    
    .row.justify-content-center
      .col-lg-9.col-md-9
        .card.shadow
          .card-body
            .row.mb-3
              .col-12
                .d-flex.justify-content-start
                  a(href='/asset-categories' class='btn btn-outline-primary btn-sm')
                    i.fas.fa-arrow-left.me-2
                    | Back to Categories
            
            form(action=(isEdit && category ? `/asset-categories/${category.id}?_method=PUT` : '/asset-categories'), method='POST', id='categoryForm', novalidate, class='form-container')
              .row
                .col-md-6
                  // Left Column
                  .form-group.mb-4
                    .row.align-items-end
                      .col-6
                        label(for='name' class='form-label required-field')
                          i.fas.fa-folder.me-2
                          | Category Name *
                        input(type='text' class='form-control' id='name' name='name' 
                              value=(isEdit && category ? category.name : (formData && formData.name ? formData.name : '')) 
                              required
                              placeholder='Enter category name')
                        .invalid-feedback
                          | Category name is required
                      .col-6
                        label(for='category_id' class='form-label')
                          i.fas.fingerprint.me-2
                          | Category ID
                        input(type='text' class='form-control-plaintext' id='category_id' 
                              value=(isEdit && category ? category.id : 'New') 
                              readonly)
                
                  .form-group.mb-4
                    label(for='is_active' class='form-label')
                      i.fas.fa-toggle-on.me-2
                      | Status
                    select(class='form-select' id='is_active' name='is_active')
                      option(value='true' selected=(isEdit ? (category && category.is_active) : true)) Active
                      option(value='false' selected=(isEdit ? (category && !category.is_active) : false)) Inactive
                
                // Right Column - Empty column for alignment
                .col-md-6
                  // Space for additional fields if needed in the future
              
              // Full width row for description
              .row.mb-4
                .col-12
                  .form-group
                    label(for='description' class='form-label')
                      i.fas.fa-align-left.me-2
                      | Description
                    textarea(class='form-control' id='description' name='description' rows='3'
                            placeholder='Enter category description')= (isEdit && category ? (category.description || '') : (formData && formData.description ? formData.description : ''))
              
              .row.mt-4
                .col-6
                  a.btn.btn-secondary(href='/asset-categories')
                    i.fas.fa-times.me-2
                    | Cancel
                .col-6.text-end
                  button.btn.btn-primary(type='submit')
                    i.fas.fa-save.me-2
                    = isEdit ? 'Update Category' : 'Create Category'
                
                if isEdit
                  .col-12.mt-3.text-end
                    button.btn.btn-outline-danger(type='button', data-bs-toggle='modal', data-bs-target='#deleteModal')
                      i.fas.fa-trash.me-2
                      | Delete Category

    // Delete Confirmation Modal
    if isEdit
      .modal.fade(id='deleteModal', tabindex='-1', aria-labelledby='deleteModalLabel', aria-hidden='true')
        .modal-dialog
          .modal-content
            .modal-header
              h5.modal-title(id='deleteModalLabel') Confirm Delete
              button.btn-close(type='button', data-bs-dismiss='modal', aria-label='Close')
            .modal-body
              p Are you sure you want to delete this category?
              p.text-danger
                strong Warning: This action cannot be undone and may affect assets assigned to this category.
            .modal-footer
              button.btn.btn-secondary(type='button', data-bs-dismiss='modal') Cancel
              form(method='POST', action='/asset-categories/#{category.id}/delete', style='display: inline;')
                button.btn.btn-danger(type='submit')
                  i.fas.fa-trash.me-2
                  | Delete Category
